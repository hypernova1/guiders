-- 도시
CREATE TABLE CITY (
	CTNO  INT          NOT NULL, -- 도시번호
	CNAME VARCHAR(100) NOT NULL  -- 도시명칭
);

-- 도시
ALTER TABLE CITY
	ADD CONSTRAINT CITY_PK -- CITY_PK
		PRIMARY KEY (
			CTNO -- 도시번호
		);

-- 팔로우
CREATE TABLE FOLLOWER (
	FNO     INT          NOT NULL, -- 팔로우번호
	FOLLOW  VARCHAR(100) NOT NULL, -- 팔로워
	GUIDER  VARCHAR(100) NOT NULL, -- 가이더
	REGDATE DATE         NOT NULL  -- 맺은날짜
);

-- 팔로우
ALTER TABLE FOLLOWER
	ADD CONSTRAINT FOLLOWER_PK -- FOLLOWER_PK
		PRIMARY KEY (
			FNO -- 팔로우번호
		);

-- 멤버
CREATE TABLE MEMBER (
	EMAIL    VARCHAR(100) NOT NULL, -- 이메일
	PASSWORD VARCHAR(50)  NOT NULL, -- 비밀번호
	MNAME    VARCHAR(30)  NOT NULL, -- 이름
	GENDER   INT          NOT NULL, -- 성별
	PHONE    VARCHAR(20)  NOT NULL, -- 전화번호
	PHOTO    VARCHAR(100) NOT NULL, -- 사진경로
	CTNO     INT          NOT NULL, -- 지역
	REGDATE  DATE         NOT NULL  -- 가입일
);

-- 멤버
ALTER TABLE MEMBER
	ADD CONSTRAINT MEMBER_PK -- MEMBER_PK
		PRIMARY KEY (
			EMAIL -- 이메일
		);

-- 가이더
CREATE TABLE GUIDER (
	EMAIL       VARCHAR(100) NOT NULL, -- 멤버번호
	INTRODUTION TEXT         NOT NULL, -- 경력란
	QUOTE       TEXT         NOT NULL, -- 인용문
	FIELD       VARCHAR(30)  NOT NULL, -- 분야
	LANG        VARCHAR(30)  NOT NULL  -- 언어
);

-- 가이더
ALTER TABLE GUIDER
	ADD CONSTRAINT MENTOR_PK -- MENTOR_PK
		PRIMARY KEY (
			EMAIL -- 멤버번호
		);

-- 멘토링
CREATE TABLE MENTORING (
	MTRNO     INT          NOT NULL, -- 멘토링번호
	MENTORNO  VARCHAR(100) NOT NULL, -- 가이더번호
	MENTINO   VARCHAR(100) NOT NULL, -- 팔로워번호
	MTITLE    VARCHAR(100) NOT NULL, -- 제목
	MCONTENT  LONGTEXT     NOT NULL, -- 내용
	MREPLY    LONGTEXT     NOT NULL, -- 답글
	REGDATE   DATE         NOT NULL, -- 등록일
	REPLYDATE DATE         NULL,     -- 답변일
	LIKECNT   INT          NOT NULL  -- 좋아요개수
);

-- 멘토링
ALTER TABLE MENTORING
	ADD CONSTRAINT MENTORING_PK -- MENTORING_PK
		PRIMARY KEY (
			MTRNO -- 멘토링번호
		);

-- 멘토링리뷰
CREATE TABLE MTR_REVIEW (
	MRNO  INT NOT NULL, -- 리뷰번호
	MTRNO INT NOT NULL  -- 멘토링번호
);

-- 멘토링리뷰
ALTER TABLE MTR_REVIEW
	ADD CONSTRAINT MTRREVIEW_PK -- MTRREVIEW_PK
		PRIMARY KEY (
			MRNO,  -- 리뷰번호
			MTRNO  -- 멘토링번호
		);

-- 참여자
CREATE TABLE PARTICIPANTS (
	RVNO  INT          NOT NULL, -- 예약번호
	EMAIL VARCHAR(100) NOT NULL  -- 참여자
);

-- 참여자
ALTER TABLE PARTICIPANTS
	ADD CONSTRAINT PARTICIPANTS_PK -- PARTICIPANTS_PK
		PRIMARY KEY (
			RVNO,  -- 예약번호
			EMAIL  -- 참여자
		);

-- 좋아요
CREATE TABLE RECOMMEND (
	COL   INT          NOT NULL, -- 에세이번호
	EMAIL VARCHAR(100) NOT NULL  -- 이메일
);

-- 좋아요
ALTER TABLE RECOMMEND
	ADD CONSTRAINT RECOMMEND_PK -- RECOMMEND_PK
		PRIMARY KEY (
			COL,   -- 에세이번호
			EMAIL  -- 이메일
		);

-- 장소예약
CREATE TABLE RESERVATION (
	RVNO      INT          NOT NULL, -- 예약번호
	PNO       INT          NOT NULL, -- 장소번호
	REMARKS   VARCHAR(200) NULL,     -- 비고
	REGDATE   DATE         NOT NULL, -- 등록일
	RESERDATE DATE         NOT NULL  -- 예약시간
);

-- 장소예약
ALTER TABLE RESERVATION
	ADD CONSTRAINT RESERVATION_PK -- RESERVATION_PK
		PRIMARY KEY (
			RVNO -- 예약번호
		);

-- 리뷰
CREATE TABLE REVIEW (
	RVNO      INT          NOT NULL, -- 리뷰번호
	EMAIL     VARCHAR(100) NOT NULL, -- 이메일
	STARCNT   INT          NOT NULL, -- 별개수
	RVCONTENT VARCHAR(200) NOT NULL, -- 리뷰내용
	REGDATE   DATE         NOT NULL  -- 등록일
);

-- 리뷰
ALTER TABLE REVIEW
	ADD CONSTRAINT REVIEW_PK -- REVIEW_PK
		PRIMARY KEY (
			RVNO -- 리뷰번호
		);

-- 제휴장소
CREATE TABLE PLACE (
	PNO     INT          NOT NULL, -- 장소번호
	PNAME   VARCHAR(20)  NOT NULL, -- 장소이름
	ADDRESS VARCHAR(100) NOT NULL, -- 주소
	PHONE   VARCHAR(30)  NOT NULL  -- 전화번호
);

-- 제휴장소
ALTER TABLE PLACE
	ADD CONSTRAINT PLACE_PK -- PLACE_PK
		PRIMARY KEY (
			PNO -- 장소번호
		);

-- 장소리뷰
CREATE TABLE P_REVIEW (
	RVNO INT NOT NULL, -- 리뷰번호
	PNO  INT NOT NULL  -- 장소번호
);

-- 장소리뷰
ALTER TABLE P_REVIEW
	ADD CONSTRAINT PK_P_REVIEW -- 장소리뷰 기본키
		PRIMARY KEY (
			RVNO, -- 리뷰번호
			PNO   -- 장소번호
		);

-- 에세이
CREATE TABLE ESSAY (
	COL      INT          NOT NULL, -- 에세이번호
	EMAIL    VARCHAR(100) NOT NULL, -- 이메일
	FIELD    VARCHAR(30)  NOT NULL, -- 분야
	LANG     VARCHAR(30)  NOT NULL, -- 언어
	ETITLE   VARCHAR(200) NOT NULL, -- 제목
	ECONTENT LONGTEXT     NOT NULL, -- 내용
	LIKECNT  INT          NOT NULL, -- 좋아요개수
	REGDATE  DATE         NOT NULL  -- 작성일
);

-- 에세이
ALTER TABLE ESSAY
	ADD CONSTRAINT PK_ESSAY -- 에세이 기본키
		PRIMARY KEY (
			COL -- 에세이번호
		);

-- 팔로우
ALTER TABLE FOLLOWER
	ADD CONSTRAINT FK_FOLLOWER_FOLLOWER_MEMBER_MN -- FK_FOLLOWER_FOLLOWER_MEMBER_MN
		FOREIGN KEY (
			GUIDER -- 가이더
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 팔로우
ALTER TABLE FOLLOWER
	ADD CONSTRAINT FK_FOLLOWER_FOLLOWING_MEMBER_M -- FK_FOLLOWER_FOLLOWING_MEMBER_M
		FOREIGN KEY (
			FOLLOW -- 팔로워
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 멤버
ALTER TABLE MEMBER
	ADD CONSTRAINT FK_MEMBER_CTNO_CITY_CTNO -- FK_MEMBER_CTNO_CITY_CTNO
		FOREIGN KEY (
			CTNO -- 지역
		)
		REFERENCES CITY ( -- 도시
			CTNO -- 도시번호
		);

-- 가이더
ALTER TABLE GUIDER
	ADD CONSTRAINT FK_MENTOR_MNO_MEMBER_MNO -- FK_MENTOR_MNO_MEMBER_MNO
		FOREIGN KEY (
			EMAIL -- 멤버번호
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 멘토링
ALTER TABLE MENTORING
	ADD CONSTRAINT FK_MEMBER_TO_MENTORING -- 멤버 -> 멘토링2
		FOREIGN KEY (
			MENTORNO -- 가이더번호
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 멘토링
ALTER TABLE MENTORING
	ADD CONSTRAINT FK_MEMBER_TO_MENTORING2 -- 멤버 -> 멘토링
		FOREIGN KEY (
			MENTINO -- 팔로워번호
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 멘토링리뷰
ALTER TABLE MTR_REVIEW
	ADD CONSTRAINT FK_MTRREVIEW_MRNO_REVIEW_RVNO -- FK_MTRREVIEW_MRNO_REVIEW_RVNO
		FOREIGN KEY (
			MRNO -- 리뷰번호
		)
		REFERENCES REVIEW ( -- 리뷰
			RVNO -- 리뷰번호
		);

-- 멘토링리뷰
ALTER TABLE MTR_REVIEW
	ADD CONSTRAINT FK_MENTORING_TO_MTR_REVIEW -- 멘토링 -> 멘토링리뷰
		FOREIGN KEY (
			MTRNO -- 멘토링번호
		)
		REFERENCES MENTORING ( -- 멘토링
			MTRNO -- 멘토링번호
		);

-- 참여자
ALTER TABLE PARTICIPANTS
	ADD CONSTRAINT FK_PARTICIPANTS_MNO_MEMBER_MNO -- FK_PARTICIPANTS_MNO_MEMBER_MNO
		FOREIGN KEY (
			EMAIL -- 참여자
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 참여자
ALTER TABLE PARTICIPANTS
	ADD CONSTRAINT FK_PARTICIPANTS_RVNO_RESERVATI -- FK_PARTICIPANTS_RVNO_RESERVATI
		FOREIGN KEY (
			RVNO -- 예약번호
		)
		REFERENCES RESERVATION ( -- 장소예약
			RVNO -- 예약번호
		);

-- 좋아요
ALTER TABLE RECOMMEND
	ADD CONSTRAINT FK_ESSAY_TO_RECOMMEND -- 에세이 -> 좋아요
		FOREIGN KEY (
			COL -- 에세이번호
		)
		REFERENCES ESSAY ( -- 에세이
			COL -- 에세이번호
		);

-- 좋아요
ALTER TABLE RECOMMEND
	ADD CONSTRAINT FK_MEMBER_TO_RECOMMEND -- 멤버 -> 좋아요
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 장소예약
ALTER TABLE RESERVATION
	ADD CONSTRAINT FK_RESERVATION_PNO_PLACE_PNO -- FK_RESERVATION_PNO_PLACE_PNO
		FOREIGN KEY (
			PNO -- 장소번호
		)
		REFERENCES PLACE ( -- 제휴장소
			PNO -- 장소번호
		);

-- 리뷰
ALTER TABLE REVIEW
	ADD CONSTRAINT FK_MEMBER_TO_REVIEW -- 멤버 -> 리뷰
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);

-- 장소리뷰
ALTER TABLE P_REVIEW
	ADD CONSTRAINT FK_REVIEW_TO_P_REVIEW -- 리뷰 -> 장소리뷰
		FOREIGN KEY (
			RVNO -- 리뷰번호
		)
		REFERENCES REVIEW ( -- 리뷰
			RVNO -- 리뷰번호
		);

-- 장소리뷰
ALTER TABLE P_REVIEW
	ADD CONSTRAINT FK_PLACE_TO_P_REVIEW -- 제휴장소 -> 장소리뷰
		FOREIGN KEY (
			PNO -- 장소번호
		)
		REFERENCES PLACE ( -- 제휴장소
			PNO -- 장소번호
		);

-- 에세이
ALTER TABLE ESSAY
	ADD CONSTRAINT FK_MEMBER_TO_ESSAY -- 멤버 -> 에세이
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES MEMBER ( -- 멤버
			EMAIL -- 이메일
		);